{% load static %}
{% load socialaccount %}

<!-- Top Bar -->
<div class="bg-dark text-white py-1 d-none d-md-block">
  <div class="container d-flex justify-content-between small">
    <span>üìß support@vetrijobs.com</span>
    <span>üïò Mon‚ÄìFri | 9:00 AM ‚Äì 6:00 PM</span>
  </div>
</div>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm sticky-top py-2 border-bottom"
     style="backdrop-filter: blur(8px); background: rgba(255,255,255,0.95);">

  <div class="container">

    <!-- Logo -->
    <a class="navbar-brand d-flex align-items-center gap-2 fw-bold text-dark"
       href="{% url 'home' %}">
      <img src="{% static 'images/logo.png' %}" alt="Logo" height="42">
      <span class="fs-5">Vetri Jobs</span>
    </a>

    <!-- Toggle -->
    <button class="navbar-toggler" type="button"
            data-bs-toggle="collapse"
            data-bs-target="#mainNavbar">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="mainNavbar">

      <!-- CENTER MENU -->
      <ul class="navbar-nav mx-auto gap-3">

        <li class="nav-item">
          <a class="nav-link fw-medium px-2
             {% if request.path == '/home/' %}text-primary border-bottom border-2 border-primary{% endif %}"
             href="{% url 'home' %}">
            Home
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link fw-medium px-2
             {% if '/jobs' in request.path %}text-primary border-bottom border-2 border-primary{% endif %}"
             href="{% url 'jobs:list' %}">
            Jobs
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link fw-medium px-2
             {% if '/training/' in request.path %}text-primary border-bottom border-2 border-primary{% endif %}"
             href="{% url 'training:home' %}">
            Training
          </a>
        </li>

      </ul>

      <!-- RIGHT SIDE -->
      <div class="d-flex align-items-center gap-3">

{% if user.is_authenticated %}

  <!-- Greeting -->
  <div class="px-3 py-1 rounded-pill small fw-semibold"
       style="background:#f0f4ff; color:#2b4eff;">
    {% if user.is_authenticated %}
    Hi {{ user.first_name|title }}
{% endif %}
  </div>

  {# ================= ADMIN ================= #}
  {% if user.is_superuser %}

      <a href="{% url 'dashboard:admin' %}"
         class="btn btn-outline-dark btn-sm rounded-pill px-3">
        Admin Panel
      </a>

  {# ================= CONSULTANT ================= #}
  {% elif user.profile.role == "CONSULTANT" %}

      <a href="{% url 'mock_interviews:consultant_dashboard' %}"
         class="btn btn-outline-primary btn-sm rounded-pill px-3">
        Consultant Dashboard
      </a>

  {# ================= NORMAL USER ================= #}
  {% else %}

      <a href="{% url 'profiles:view' %}"
         class="nav-link fw-medium">
        Profile
      </a>

      <a href="{% url 'profiles:setup' %}"
         class="nav-link fw-medium">
        Setup
      </a>

      <a href="{% url 'dashboard:user' %}"
         class="btn btn-primary btn-sm rounded-pill px-3 shadow-sm">
        Dashboard
      </a>

      {# ===== Subscription Logic ===== #}
      {% with sub=user.subscription|default_if_none:"" %}
        {% if sub and sub.plan == "FREE" %}
          <a href="{% url 'subscriptions:plan_select' %}"
             class="btn btn-warning btn-sm fw-semibold rounded-pill px-3 shadow-sm">
            Upgrade
          </a>

        {% elif sub and sub.plan == "PRO" %}
          <span class="badge bg-success rounded-pill px-3 py-2">
            PRO ‚úì
          </span>

        {% elif sub and sub.plan == "PRO_PLUS" %}
          <span class="badge bg-warning text-dark rounded-pill px-3 py-2">
            PRO PLUS ‚≠ê
          </span>

        {% else %}
          <a href="{% url 'subscriptions:plan_select' %}"
             class="btn btn-outline-primary btn-sm rounded-pill px-3">
            Choose Plan
          </a>
        {% endif %}
      {% endwith %}

  {% endif %}

  <!-- Logout -->
  <form method="post" action="{% url 'account_logout' %}">
    {% csrf_token %}
    <button type="submit"
            class="btn btn-outline-danger btn-sm rounded-pill px-3">
      Logout
    </button>
  </form>

{% else %}

  <a href="{% url 'account_login' %}"
     class="nav-link fw-medium">
    Login
  </a>

  <a href="/admin/login/"
     class="nav-link text-danger fw-semibold">
    Admin
  </a>

  

{% endif %}

</div>

    </div>
  </div>
</nav>

